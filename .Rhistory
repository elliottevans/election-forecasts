#   ,s.state as state_full
#   ,`Electoral.Votes` as state_electoral_votes
#   ,`X.Location` as x_location
#   ,`Y.Location` as y_location
#   ,NULL as Pollster
#   ,NULL as Candidate
#   ,NULL as poll_value
#   ,NULL as party
#   ,`X2004` as `2004_state_result`
#   ,`X2008` as `2008_state_result`
#   ,`X2012` as `2012_state_result`
# from year_df y
#   inner join model_df m on 1=1
#   inner join states_df s on 1=1
#   inner join state_abb sa on sa.name=s.state
#   inner join electoral_votes ev on ev.State=s.state
#   inner join state_actuals on state_actuals.State=sa.name
# ")
#
# master_forecasts<-data.frame(rbind(master_forecasts,dummy))
# ######################################################################
# # INCLDE DUMMY DATA FOR STATES THAT HAVENT BEEN POLLED YET
# ######################################################################
#
#
# write.csv(master_forecasts,'forecasts\\master_forecasts.csv',row.names = FALSE)
#########################################################################
#Final Probability
#########################################################################
election_test<-sql("
select
name
,case when dem_prob is not null then dem_prob else hist_dem_prob end as dem_prob
,electoral_votes
from
(
select
name
,case when num_dems=0 then round(round(1,10)/round(11,10),4)
when num_dems=10 then round(round(10,10)/round(11,10),4)
else round(round(num_dems,10)/round(10,10),4) end hist_dem_prob
,dem_prob
,electoral_votes
from
(
select
name
,case when `1976_state_result`='D' then 1 else 0 end
+case when `1980_state_result`='D' then 1 else 0 end
+case when `1984_state_result`='D' then 1 else 0 end
+case when `1988_state_result`='D' then 1 else 0 end
+case when `1992_state_result`='D' then 1 else 0 end
+case when `1996_state_result`='D' then 1 else 0 end
+case when `2000_state_result`='D' then 1 else 0 end
+case when `2004_state_result`='D' then 1 else 0 end
+case when `2008_state_result`='D' then 1 else 0 end
+case when `2012_state_result`='D' then 1 else 0 end as num_dems
,case when candidate='Clinton' then value else null end as dem_prob
,electoral_votes
from poll_data
group by 1
) temp1
) temp2
"
)
dem_wins<-0
electoral_vote_list<-c()
for(i in 1:10000){
electoral_votes<-0
for(j in 1:nrow(election_test)){
win_or_lose<-rbinom(1,1,election_test[j,'dem_prob'])
if(win_or_lose==1){
electoral_votes<-electoral_votes+election_test[j,'electoral_votes']
}
}
electoral_vote_list<-append(electoral_vote_list,electoral_votes)
if(electoral_votes>=270){
dem_wins<-dem_wins+1
}
}
hist_data<-
data.frame(
rbind(
cbind(rep('Clinton',length(electoral_vote_list)),electoral_vote_list)
,cbind(rep('Trump',length(electoral_vote_list)),538-electoral_vote_list)
)
)
names(hist_data)<-c('candidate','electoral_votes')
hist_data$electoral_votes<-as.numeric(as.character(hist_data$electoral_votes))
sum_dat<-ddply(hist_data, "candidate", summarise, electoral_votes.mean=mean(electoral_votes))
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=1+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=3+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=6+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=9+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=12+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=25+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=3+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=3+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=11)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=3+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=7)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=3+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=3)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=3+sum_dat[sum_dat$candidate=='Clinton',2], label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=5)
if(sum_dat[sum_dat$candidate=='Clinton',2]>=270){
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]+4
trump_label_spot<-clinton_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]-4
}else{
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]-4
trump_label_spot<-clinton_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]+4
}
clinton_label_spot
sum_dat[sum_dat$candidate=='Clinton',2]
sum_dat[sum_dat$candidate=='Clinton',2]
if(sum_dat[sum_dat$candidate=='Clinton',2]>=270){
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]+4
trump_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]-4
}else{
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]-4
trump_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]+4
}
clinton_label_spot
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=1+round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=5)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="blue", angle=90,size=5)
if(sum_dat[sum_dat$candidate=='Clinton',2]>=270){
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]+5
trump_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]-5
}else{
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]-5
trump_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]+5
}
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3", angle=90,size=5)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3", angle=90,size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3", angle=90,size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=60), colour="red3", angle=90,size=5)
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue", angle=90,size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3", angle=90,size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=60), colour="red3", angle=90,size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=130), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)
if(sum_dat[sum_dat$candidate=='Clinton',2]>=270){
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]+9
trump_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]-9
}else{
clinton_label_spot<-sum_dat[sum_dat$candidate=='Clinton',2]-9
trump_label_spot<-sum_dat[sum_dat$candidate=='Trump',2]+9
}
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
xlabel("Simulated Outcome")
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
xlab("Simulated Outcome")
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=30), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=30), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=19))
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=24))
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=24))+
theme(legend.text = element_text(colour="blue", size = 16, face = "bold"))
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=24))+
theme(legend.text = element_text(colour=c('blue','red'), size = 16, face = "bold"))
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=24))+
theme(legend.text = element_text(size = 14, face = "bold"))
ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=24))+
theme(legend.text = element_text(size = 12, face = "bold"))
simulated_result<-ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=5)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=5)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=5)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Simulated Outcome")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=24))+
theme(legend.text = element_text(size = 12, face = "bold"))
simulated_result
simulated_result<-ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=8)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=8)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=8)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Electoral Votes")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=31))+
theme(plot.xlab=element_text(face="bold",size=17))+
theme(legend.text = element_text(size = 16, face = "bold"))
simulated_result<-ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=8)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=8)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=8)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Electoral Votes")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=31))+
theme(axis.text=element_text(size=17))+
theme(legend.text = element_text(size = 16, face = "bold"))
simulated_result<-ggplot(hist_data, aes(x=electoral_votes, fill=candidate)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")+
scale_fill_manual(values=c("deepskyblue", "firebrick1"))+
geom_vline(data=sum_dat, aes(xintercept=electoral_votes.mean),
linetype="dashed", size=1,color=c('blue','red3'))+
geom_text(aes(x=clinton_label_spot, label=round(sum_dat[sum_dat$candidate=='Clinton',2]), y=60), colour="blue",size=8)+
geom_text(aes(x=trump_label_spot, label=round(sum_dat[sum_dat$candidate=='Trump',2]), y=60), colour="red3",size=8)+
geom_text(aes(x=270+5, label='270 to Win', y=1000), colour="red3",size=8)+
geom_vline(data=sum_dat, aes(xintercept=270),
linetype="dashed", size=1)+
ggtitle("Electoral Votes")+
ylab("Frequency")+
xlab("Electoral Votes")+
guides(fill=guide_legend(title=NULL))+
theme(plot.title=element_text(face="bold",hjust=0,vjust=2,colour="#3C3C3C",size=31))+
theme(axis.text=element_text(size=23))+
theme(legend.text = element_text(size = 19, face = "bold"))
source('~/election_forecasts/main.R')
dem_prob
fit_weighted
summary(fit_weighted)
n<-10000
dem_wins<-0
electoral_vote_list<-c()
for(i in 1:n){
electoral_votes<-0
for(j in 1:nrow(election_test)){
win_or_lose<-rbinom(1,1,election_test[j,'dem_prob'])
if(win_or_lose==1){
electoral_votes<-electoral_votes+election_test[j,'electoral_votes']
}
}
electoral_vote_list<-append(electoral_vote_list,electoral_votes)
if(electoral_votes>=270){
dem_wins<-dem_wins+1
}
}
dem_prob<-dem_wins/n
dem_prob
